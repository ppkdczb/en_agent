# 基于Agent机制的大语言模型解题能力评估系统：顺序任务列表

> 目标：从用户提供的英文PDF材料自动生成题目，并对多个大语言模型进行解题、评分、统计分析，最终产出评估报告。

## 1. 需求与配置

1. 明确评估范围与输出
   - 题型：完形填空（cloze）、阅读理解选择题（reading_mcq）
   - 难度：easy/medium/hard（比例可配置）
   - 题量：每种题型数量可配置
   - 出题Agent模式：
     - 生成新题（从英文材料抽取内容，自动生成题目+标准答案）
     - 提取真题（从“真题PDF”中结构化抽取题干/选项；如PDF含答案则同步抽取）
   - 待测模型列表：如 GPT-4、Claude、Gemini（可扩展）
   - 评分维度：正确性、语言逻辑性、思维合理性（各 0–10）
   - 报告格式：Markdown（可选导出 PDF）

2. 约束与非功能需求
   - 速率限制/重试/超时策略
   - 成本控制：缓存、并发上限、批量策略
   - 可复现：记录配置、版本、随机性控制（评分模型 temperature=0）

## 2. 项目骨架与基础设施

3. 初始化项目结构
   - `configs/`：运行配置
   - `data/`：输入PDF（或示例）
   - `outputs/`：题目/答案/评分/统计/报告
   - `src/`：核心代码

4. 配置与密钥管理
   - 使用环境变量/`.env` 管理各模型API Key
   - 统一的配置加载与校验（题量、难度比例、模型列表、并发等）

5. 日志与运行记录
   - 记录每次运行的参数、时间、异常、模型调用耗时
   - 输出可追溯的 run_id（便于对比与复跑）

## 3. PDF输入与文本预处理

6. PDF解析与抽取文本
   - PDF → 纯文本
   - 清理：去页眉页脚/多余空白（按需要）
   -（可选）扫描版PDF：OCR识别（若真题为图片型PDF）

7. 文本切分与（可选）摘要
   - 按段落/章节/长度或语义切分为 chunks
   - 长文可先摘要再出题（可配置）

## 4. 数据结构与存储格式

8. 设计数据模型（建议JSON可落盘）
   - `Question`
     - `id`、`type`、`difficulty`、`question`、`options[]`、`answer`
     - 题目来源字段（用于区分“生成题/真题”）：
       - `origin`: `generated` | `extracted`
       - `source_pdf`: 文件名/标识
       - `source_id`: 批量模式来源ID
       -（可选）`source_page` / `source_span`：用于追溯真题在PDF中的位置
   - `ModelAnswer`
     - `question_id`、`model`、`reasoning`、`answer`、`time_used`
   - `Score`
     - `question_id`、`model`、`accuracy`、`coherence`、`reasoning`、`comments`

9. 约定统一的I/O文件
   - `questions.jsonl`
   - `answers.jsonl`
   - `scores.jsonl`
   - `metrics.json`
   - `report.md`（以及可选 `report.pdf`）

## 5. 题目生成Agent（出题模块）

9. 将出题Agent独立为可复用组件
   - 提供统一入口（如CLI/脚本/API）：输入PDF与参数，输出 `questions.jsonl`
   - 支持两种工作模式：`generate`（生成新题）与 `extract`（提取真题）

10. 模式A：生成新题（从英文材料生成题目+标准答案）
   - 完形填空题生成
     - 从chunk中选词/短语挖空
     - 生成 4 选项（1正确+3干扰）
     - 难度控制（词汇复杂度、干扰项相似度）
   - 阅读理解题生成
     - 对段落生成问题与 4 选项
     - 难度分层：事实细节 / 主旨推理 / 深层推断
   - 结构化输出：严格JSON；格式校验与失败重试

11. 模式B：提取真题（从真题PDF抽取题干/选项/答案）
   - 真题结构识别
     - 识别题号、题干、选项（A/B/C/D）边界与顺序
     - 识别题型（完形/阅读/其他）：仅抽取本系统支持的题型，其余跳过或标注
   - 答案抽取（如果PDF含答案/解析）
     - 识别“答案区/参考答案/Key”等段落并与题号对齐
     - 若无答案：`answer` 置空，并在后续评分阶段改用人工答案或跳过正确性维度
   - 质量控制
     - 基本一致性校验（每题是否有4个选项、是否有题干）
     -（可选）抽样人工复核/修正接口（避免解析错误污染评测）
   - 结构化输出：严格JSON；保留 `origin=extracted` 与 `source_page/source_span` 便于追溯

12. 题目集整理（两种模式通用）
   - 合并题目、去重、分配 `id`
   - 落盘保存题目集（供后续解题与评分）

## 6. 模型解题模块（多模型作答）

13. 统一模型调用接口
   - 抽象 `ModelClient`（不同厂商的适配层）
   - 统一提示模板（要求“推理 + 最终选项”）

14. 逐题调用并记录结果
   - 每题对所有模型调用（可并发）
   - 记录原始输出、解析最终答案、记录耗时
   - 异常处理：超时/失败重试/跳过并标注

## 7. 答案评分Agent（评审模块）

15. 评分Prompt与输出约束
   - 角色：严格阅卷官
   - 输入：题目、标准答案、模型答案、模型推理
   - 输出：JSON（accuracy/coherence/reasoning/comments）
   - 参数：temperature=0，尽量可重复

16. 执行评分并回填
   - 逐题逐模型评分（或按题批量评分，视上下文与成本）
   - 从评分结果导出对错标记（直接比对或基于accuracy阈值）

## 8. 统计分析模块

17. 指标计算
   - 总体正确率、按题型正确率、按难度正确率
   - 平均评分（3维度）
   - 平均耗时与分布
   - 思维链条质量（可直接用 reasoning 维度均值）
   - 难度适应性（如 hard_acc / easy_acc）

18. 汇总结构化输出
   - 指标表（可用于Markdown表格）
   - 典型样例（用于报告展示）

## 9. 报告生成

19. Markdown报告模板
   - 总体概览、表格、结论与对比
   - 插入典型题目案例（题干/模型回答/评分评语）

20.（可选）图表与PDF导出
   - 生成柱状图/折线图（正确率、耗时、难度曲线）
   - 将Markdown转PDF（如需要）

## 10.（可选）批量处理支持

21. 多PDF输入与来源追踪
   - 支持目录/多文件
   - 题目与结果带 `source_id`

22. 批量运行与综合报告
   - 对每份PDF生成子章节
   - 生成全局汇总对比与结论
